<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>حاسبة حصّة أكل القطط (مطابقة شيت الإكسل)</title>
  <style>
    :root{
      --bg:#0f172a; --card:#0b1220; --ring:#334155; --text:#e5e7eb; --muted:#94a3b8;
      --hx:#a7f3d0; --accent:#22c55e; --accent2:#10b981; --line:#1f2937;
    }
    *{box-sizing:border-box}
    body{margin:0; background:radial-gradient(1000px 700px at 80% -10%, #1f2937 0%, var(--bg) 60%);
      color:var(--text); font-family:"Cairo", ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial}
    header{padding:28px 16px 10px; text-align:center}
    h1{margin:0; font-size:clamp(20px,4vw,32px); font-weight:800; letter-spacing:.2px;
      background:linear-gradient(90deg,#fff,var(--hx) 60%,#fff); -webkit-background-clip:text; background-clip:text; color:transparent}
    .sub{color:var(--muted); font-size:13px; margin-top:6px}
    .container{width:min(960px,92%); margin:16px auto 90px}
    .grid{display:grid; grid-template-columns:1fr; gap:14px}
    @media(min-width:860px){.grid{grid-template-columns:1fr 1fr}}
    .card{background:linear-gradient(180deg,var(--card),#091225ee); border:1px solid var(--line);
      border-radius:16px; padding:16px; box-shadow:0 10px 28px rgba(0,0,0,.25); backdrop-filter:blur(6px)}
    label{display:block; font-weight:800; margin-bottom:8px; color:#cbd5e1}
    input{width:100%; padding:12px 14px; border-radius:12px; background:#0a0f1a; border:1px solid var(--ring);
      outline:none; color:var(--text); font-size:16px}
    input::placeholder{color:#64748b}
    input:focus{border-color:var(--accent); box-shadow:0 0 0 3px #22c55e22}
    .two{display:grid; grid-template-columns:1fr; gap:10px}
    @media(min-width:600px){.two{grid-template-columns:1fr 1fr}}
    .hint{font-size:12px; color:var(--muted); margin-top:6px}
    .badge{display:inline-flex; gap:8px; align-items:center; padding:6px 10px; border-radius:999px; font-size:12px;
      background:#052e1a; border:1px solid #064e3b; color:#bbf7d0; margin-bottom:8px}
    .controls{display:flex; gap:10px; flex-wrap:wrap; margin-top:10px}
    .btn{padding:10px 14px; border-radius:12px; border:1px solid var(--line); background:#0b1325; color:var(--text);
      font-weight:800; cursor:pointer}
    .btn.primary{background:linear-gradient(90deg,var(--accent),var(--accent2)); color:#052e1a; border:none}
    .results{display:grid; grid-template-columns:1fr; gap:10px; margin-top:8px}
    @media(min-width:520px){.results{grid-template-columns:repeat(3,1fr)}}
    .result{border:1px dashed var(--line); border-radius:14px; background:#0a0f1a; padding:12px}
    .label{color:#93c5fd; font-size:12px}
    .value{font-weight:900; font-size:clamp(18px,3vw,28px)}
    .unit{font-size:.8em; color:#94a3b8; font-weight:700}
    table{width:100%; border-collapse:separate; border-spacing:0; overflow:hidden; border-radius:12px; margin-top:8px}
    thead th{background:#0b1325; color:#cbd5e1; text-align:right; padding:10px; font-size:13px; border-bottom:1px solid var(--line)}
    tbody td{padding:10px; border-bottom:1px dashed var(--line); color:#e5e7eb; font-size:14px}
    tbody tr:last-child td{border-bottom:none}
    .sep{height:1px; background:var(--line); margin:12px 0}
    footer{position:fixed; inset-inline:0; bottom:0; background:#020617f2; border-top:1px solid var(--line);
      padding:10px 14px; font-size:12.5px; color:#cbd5e1; display:flex; justify-content:center; z-index:50}
    footer .inner{width:min(960px,92%); text-align:justify; text-align-last:right}
    footer b{font-weight:900}
  </style>
</head>
<body>
  <header>
    <h1>حاسبة حصّة أكل القطط</h1>
    <div class="sub">مطابقة منطق شيت: <span class="eng">Simple Serving Calculator</span> — إدخال نسب الماكروز والرطوبة والرماد + حجم الحصّة، وحساب الكارب (NFE) والسعرات (Modified Atwater) والجرامات لكل مكوّن.</div>
  </header>

  <main class="container">
    <div class="grid">
      <section class="card">
        <div class="badge">⚙️ إدخال البيانات (نفس أعمدة الشيت)</div>
        <div class="two">
          <div>
            <label for="serving">حجم الحصّة (غ)</label>
            <input id="serving" type="number" step="0.1" min="0" placeholder="مثال: 50">
          </div>
          <div>
            <label for="protein">بروتين %</label>
            <input id="protein" type="number" step="0.1" min="0" max="100" placeholder="مثال: 10">
          </div>
        </div>
        <div class="two" style="margin-top:8px">
          <div>
            <label for="fat">دهون %</label>
            <input id="fat" type="number" step="0.1" min="0" max="100" placeholder="مثال: 5">
          </div>
          <div>
            <label for="fiber">ألياف %</label>
            <input id="fiber" type="number" step="0.1" min="0" max="100" placeholder="مثال: 1.5">
          </div>
        </div>
        <div class="two" style="margin-top:8px">
          <div>
            <label for="moisture">رطوبة %</label>
            <input id="moisture" type="number" step="0.1" min="0" max="100" placeholder="مثال: 78">
          </div>
          <div>
            <label for="ash">رماد %</label>
            <input id="ash" type="number" step="0.1" min="0" max="100" placeholder="مثال: 2.5">
          </div>
        </div>

        <div class="controls">
          <button class="btn primary" id="calc">احسب</button>
          <button class="btn" id="reset">إعادة ضبط</button>
          <div class="hint">تُحتسب <b>NFE</b> ككربوهيدرات: 100 − (بروتين + دهون + ألياف + رطوبة + رماد).</div>
        </div>
      </section>

      <section class="card">
        <div class="badge">📊 النتائج (مطابقة للشيت)</div>
        <div class="results">
          <div class="result">
            <div class="label">NFE % (الكارب المحسوب)</div>
            <div class="value"><span id="nfePct">—</span> <span class="unit">%</span></div>
          </div>
          <div class="result">
            <div class="label">kcal لكل 100غ (Modified Atwater)</div>
            <div class="value"><span id="kcal100">—</span> <span class="unit">kcal/100g</span></div>
          </div>
          <div class="result">
            <div class="label">السعرات لكل حصّة</div>
            <div class="value"><span id="kcalServing">—</span> <span class="unit">kcal</span></div>
          </div>
        </div>

        <div class="sep"></div>
        <table>
          <thead>
            <tr><th>العنصر</th><th>غرام لكل حصّة</th></tr>
          </thead>
          <tbody>
            <tr><td>البروتين</td><td id="gProtein">—</td></tr>
            <tr><td>الدهون</td><td id="gFat">—</td></tr>
            <tr><td>الألياف</td><td id="gFiber">—</td></tr>
            <tr><td>الرطوبة</td><td id="gMoisture">—</td></tr>
            <tr><td>الرماد</td><td id="gAsh">—</td></tr>
            <tr><td>NFE (الكارب)</td><td id="gNfe">—</td></tr>
          </tbody>
        </table>

        <div class="hint" style="margin-top:8px">
          عوامل Modified Atwater للحيوانات الأليفة: بروتين 3.5، كارب 3.5، دهون 8.5 (kcal/غ). القيم هنا مطبّقة على نسب المادة كما هي في 100غ والطعام الرطب يحسب كما هو مُدخل. 
        </div>
      </section>
    </div>
  </main>

  <footer>
    <div class="inner">
      <span>⚠️</span> <b>تنويه:</b> تم تصميم وتطوير المعادلة المستخدمة بشكل خاص من قِبل مطوّر الموقع دون الاعتماد على المعادلات العامة، تهدف القيم الناتجة إلى تقديم أقرب التقديرات للمساعدة فقط، ولا تُعد بديلاً عن استشارة الطبيب البيطري المختص.
    </div>
  </footer>

  <script>
    // Modified Atwater factors (kcal per gram)
    const ATW = { protein: 3.5, fat: 8.5, carb: 3.5 };

    function nfePercent(p,f,fi,m,a){
      let s = (p||0)+(f||0)+(fi||0)+(m||0)+(a||0);
      return 100 - s;
    }

    function kcalPer100g(p,f,fi,m,a){
      // Using percentages as-is for 100g basis:
      // protein grams per 100g = p, fat grams per 100g = f, carbs per 100g = nfe
      const nfe = nfePercent(p,f,fi,m,a);
      const kcal = (p*ATW.protein) + (nfe*ATW.carb) + (f*ATW.fat);
      return { kcal100: kcal, nfe };
    }

    function byPct(serving, pct){ return serving * (pct/100); }

    function fmt(x, d=1){
      if (!isFinite(x)) return '—';
      return Number(x).toFixed(d);
    }

    function calc(){
      const serving = parseFloat(document.getElementById('serving').value);
      const p = parseFloat(document.getElementById('protein').value);
      const f = parseFloat(document.getElementById('fat').value);
      const fi = parseFloat(document.getElementById('fiber').value);
      const m = parseFloat(document.getElementById('moisture').value);
      const a = parseFloat(document.getElementById('ash').value);

      if(!(serving>0)){ alert('حط حجم حصّة صحيح (غ).'); return; }
      const { kcal100, nfe } = kcalPer100g(p||0,f||0,fi||0,m||0,a||0);
      const kcalServing = kcal100 * (serving/100);

      // grams per serving from percentages
      const gP = byPct(serving, p||0);
      const gF = byPct(serving, f||0);
      const gFi = byPct(serving, fi||0);
      const gM = byPct(serving, m||0);
      const gA = byPct(serving, a||0);
      const gN = byPct(serving, nfe);

      document.getElementById('nfePct').textContent = fmt(nfe, 1);
      document.getElementById('kcal100').textContent = fmt(kcal100, 1);
      document.getElementById('kcalServing').textContent = fmt(kcalServing, 1);

      document.getElementById('gProtein').textContent = fmt(gP, 1);
      document.getElementById('gFat').textContent = fmt(gF, 1);
      document.getElementById('gFiber').textContent = fmt(gFi, 1);
      document.getElementById('gMoisture').textContent = fmt(gM, 1);
      document.getElementById('gAsh').textContent = fmt(gA, 1);
      document.getElementById('gNfe').textContent = fmt(gN, 1);
    }

    function resetAll(){
      ['serving','protein','fat','fiber','moisture','ash'].forEach(id=>document.getElementById(id).value='');
      ['nfePct','kcal100','kcalServing','gProtein','gFat','gFiber','gMoisture','gAsh','gNfe'].forEach(id=>document.getElementById(id).textContent='—');
    }

    document.getElementById('calc').addEventListener('click', calc);
    document.getElementById('reset').addEventListener('click', resetAll);
  </script>
</body>
</html>
