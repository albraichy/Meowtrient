<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ø­Ø§Ø³Ø¨Ø© Ø­ØµÙ‘Ø© Ø£ÙƒÙ„ Ø§Ù„Ù‚Ø·Ø·</title>
  <style>
    :root{
      /* light (default) */
      --bg:#f6f7fb;
      --card:#ffffff;
      --ring:#d1d5db;
      --text:#0f172a;
      --muted:#475569;
      --hx:#0ea5e9;
      --accent:#16a34a;
      --accent2:#10b981;
      --line:#e5e7eb;
      --result-bg:#f8fafc;
      --table-head:#f1f5f9;
    }
    @media (prefers-color-scheme: dark){
      :root{
        --bg:#0b1120;
        --card:#0b1220;
        --ring:#334155;
        --text:#e5e7eb;
        --muted:#94a3b8;
        --hx:#a7f3d0;
        --accent:#22c55e;
        --accent2:#10b981;
        --line:#1f2937;
        --result-bg:#0a0f1a;
        --table-head:#0b1325;
      }
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--text);
      font-family:"Cairo", ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      line-height:1.6; display:flex; flex-direction:column; min-height:100vh;
    }
    header{padding:14px 16px; text-align:center; position:sticky; top:0; z-index:5;
      background:var(--bg); border-bottom:1px solid var(--line)}
    h1{
      margin:0; font-size:clamp(18px,3.5vw,26px); font-weight:800; letter-spacing:.2px;
      background:linear-gradient(90deg,var(--text),var(--hx) 60%,var(--text));
      -webkit-background-clip:text; background-clip:text; color:transparent
    }
    .topbar{display:flex; justify-content:space-between; align-items:center; gap:10px; margin-top:6px}
    .lang-toggle{
      display:inline-flex; gap:6px; align-items:center; border:1px solid var(--line);
      border-radius:999px; padding:4px 8px; font-size:12px; background:var(--card);
    }
    .lang-toggle button{
      border:none; background:transparent; padding:4px 8px; border-radius:999px; cursor:pointer; font-weight:800; color:var(--muted)
    }
    .lang-toggle button.active{ background:var(--line); color:var(--text) }
    main{ width:min(960px,92%); margin:10px auto 20px; flex:1 }
    .grid{display:grid; grid-template-columns:1fr; gap:12px}
    @media(min-width:860px){.grid{grid-template-columns:1fr 1fr}}
    .card{
      background:var(--card); border:1px solid var(--line);
      border-radius:16px; padding:14px; box-shadow:0 8px 20px rgba(0,0,0,.06)
    }
    .section-title{font-size:13px; font-weight:800; color:#065f46; background:#d1fae5; /* light */
      display:inline-flex; align-items:center; gap:8px; padding:5px 10px; border-radius:999px; margin-bottom:6px; border:1px solid #a7f3d0}
    @media (prefers-color-scheme: dark){
      .section-title{ color:#bbf7d0; background:#052e1a; border:1px solid #064e3b }
    }
    label{
      display:block; font-weight:700; margin-bottom:6px;
      font-size:14px;
    }
    input{
      width:100%; padding:10px 12px; border-radius:12px; background:transparent; border:1px solid var(--ring);
      outline:none; font-size:15px; color:var(--text)
    }
    input::placeholder{color:#94a3b8}
    input:focus{border-color:var(--accent); box-shadow:0 0 0 3px #22c55e22}
    .two{display:grid; grid-template-columns:1fr; gap:8px}
    @media(min-width:600px){.two{grid-template-columns:1fr 1fr}}
    .controls{display:flex; gap:10px; flex-wrap:wrap; margin-top:8px}
    .btn{padding:10px 14px; border-radius:12px; border:1px solid var(--line); background:var(--table-head); color:var(--text);
      font-weight:800; cursor:pointer}
    .btn.primary{background:linear-gradient(90deg,var(--accent),var(--accent2)); color:white; border:none}
    .results{display:grid; grid-template-columns:1fr; gap:8px; margin-top:6px}
    @media(min-width:520px){.results{grid-template-columns:repeat(3,1fr)}}
    .result{border:1px dashed var(--line); border-radius:14px; background:var(--result-bg); padding:12px}
    .label{color:#0369a1; font-size:12px}
    @media (prefers-color-scheme: dark){ .label{color:#93c5fd} }
    .value{font-weight:900; font-size:clamp(18px,3vw,26px)}
    .unit{font-size:.8em; color:#64748b; font-weight:700}
    table{width:100%; border-collapse:separate; border-spacing:0; overflow:hidden; border-radius:12px; margin-top:6px}
    thead th{background:var(--table-head); color:var(--text); text-align:right; padding:10px; font-size:13px; border-bottom:1px solid var(--line)}
    tbody td{padding:10px; border-bottom:1px dashed var(--line); font-size:14px}
    tbody tr:last-child td{border-bottom:none}
    footer{padding:16px 0 26px; text-align:center; color:#64748b; font-size:12.5px}
  </style>
</head>
<body>
  <header>
    <h1 data-i18n="title">Ø­Ø§Ø³Ø¨Ø© Ø­ØµÙ‘Ø© Ø£ÙƒÙ„ Ø§Ù„Ù‚Ø·Ø·</h1>
    <div class="topbar">
      <div></div>
      <div class="lang-toggle" role="tablist" aria-label="Language">
        <button id="btn-ar" class="active" data-lang="ar" role="tab" aria-selected="true">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</button>
        <button id="btn-en" data-lang="en" role="tab" aria-selected="false">English</button>
      </div>
    </div>
  </header>

  <main>
    <div class="grid">
      <section class="card">
        <div class="section-title" data-i18n="inputs">âš™ï¸ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</div>
        <div class="two">
          <div>
            <label for="serving" data-i18n="serving_label">Ø­Ø¬Ù… Ø§Ù„Ø­ØµÙ‘Ø© (Øº)</label>
            <input id="serving" inputmode="decimal" pattern="[0-9]*[.,]?[0-9]*" enterkeyhint="done" type="text" placeholder="50">
          </div>
          <div>
            <label for="protein" data-i18n="protein">Ø¨Ø±ÙˆØªÙŠÙ† %</label>
            <input id="protein" inputmode="decimal" pattern="[0-9]*[.,]?[0-9]*" enterkeyhint="next" type="text" placeholder="10">
          </div>
        </div>
        <div class="two" style="margin-top:6px">
          <div>
            <label for="fat" data-i18n="fat">Ø¯Ù‡ÙˆÙ† %</label>
            <input id="fat" inputmode="decimal" pattern="[0-9]*[.,]?[0-9]*" type="text" placeholder="5">
          </div>
          <div>
            <label for="fiber" data-i18n="fiber">Ø£Ù„ÙŠØ§Ù %</label>
            <input id="fiber" inputmode="decimal" pattern="[0-9]*[.,]?[0-9]*" type="text" placeholder="1.5">
          </div>
        </div>
        <div class="two" style="margin-top:6px">
          <div>
            <label for="moisture" data-i18n="moisture">Ø±Ø·ÙˆØ¨Ø© %</label>
            <input id="moisture" inputmode="decimal" pattern="[0-9]*[.,]?[0-9]*" type="text" placeholder="78">
          </div>
          <div>
            <label for="ash" data-i18n="ash">Ø±Ù…Ø§Ø¯ %</label>
            <input id="ash" inputmode="decimal" pattern="[0-9]*[.,]?[0-9]*" type="text" placeholder="2.5">
          </div>
        </div>

        <div class="controls">
          <button class="btn primary" id="calc" data-i18n="calc">Ø§Ø­Ø³Ø¨</button>
          <button class="btn" id="reset" data-i18n="reset">Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·</button>
        </div>
      </section>

      <section class="card">
        <div class="section-title" data-i18n="results">ğŸ“Š Ø§Ù„Ù†ØªØ§Ø¦Ø¬</div>
        <div class="results">
          <div class="result">
            <div class="label" data-i18n="nfe_label">% NFE (Ø§Ù„ÙƒØ§Ø±Ø¨ Ø§Ù„Ù…Ø­Ø³ÙˆØ¨)</div>
            <div class="value"><span id="nfePct">â€”</span> <span class="unit">%</span></div>
          </div>
          <div class="result">
            <div class="label" data-i18n="kcal100_label">kcal Ù„ÙƒÙ„ 100Øº</div>
            <div class="value"><span id="kcal100">â€”</span> <span class="unit">kcal/100g</span></div>
          </div>
          <div class="result">
            <div class="label" data-i18n="kcal_serving">Ø§Ù„Ø³Ø¹Ø±Ø§Øª Ù„ÙƒÙ„ Ø­ØµÙ‘Ø©</div>
            <div class="value"><span id="kcalServing">â€”</span> <span class="unit">kcal</span></div>
          </div>
        </div>

        <div class="sep"></div>
        <table>
          <thead>
            <tr>
              <th data-i18n="col_item">Ø§Ù„Ø¹Ù†ØµØ±</th>
              <th data-i18n="col_grams">ØºØ±Ø§Ù… Ù„ÙƒÙ„ Ø­ØµÙ‘Ø©</th>
            </tr>
          </thead>
          <tbody>
            <tr><td data-i18n="p">Ø§Ù„Ø¨Ø±ÙˆØªÙŠÙ†</td><td id="gProtein">â€”</td></tr>
            <tr><td data-i18n="f">Ø§Ù„Ø¯Ù‡ÙˆÙ†</td><td id="gFat">â€”</td></tr>
            <tr><td data-i18n="fi">Ø§Ù„Ø£Ù„ÙŠØ§Ù</td><td id="gFiber">â€”</td></tr>
            <tr><td data-i18n="m">Ø§Ù„Ø±Ø·ÙˆØ¨Ø©</td><td id="gMoisture">â€”</td></tr>
            <tr><td data-i18n="a">Ø§Ù„Ø±Ù…Ø§Ø¯</td><td id="gAsh">â€”</td></tr>
            <tr><td data-i18n="nfe">NFE (Ø§Ù„ÙƒØ§Ø±Ø¨)</td><td id="gNfe">â€”</td></tr>
          </tbody>
        </table>
      </section>
    </div>
  </main>

  <footer>
    <span id="rights">Â© 2025 albraichy â€” Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©.</span>
  </footer>

  <script>
    // i18n strings
    const STR = {
      ar: {
        title: "Ø­Ø§Ø³Ø¨Ø© Ø­ØµÙ‘Ø© Ø£ÙƒÙ„ Ø§Ù„Ù‚Ø·Ø·",
        inputs: "âš™ï¸ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª",
        serving_label: "Ø­Ø¬Ù… Ø§Ù„Ø­ØµÙ‘Ø© (Øº)",
        protein: "Ø¨Ø±ÙˆØªÙŠÙ† %",
        fat: "Ø¯Ù‡ÙˆÙ† %",
        fiber: "Ø£Ù„ÙŠØ§Ù %",
        moisture: "Ø±Ø·ÙˆØ¨Ø© %",
        ash: "Ø±Ù…Ø§Ø¯ %",
        calc: "Ø§Ø­Ø³Ø¨",
        reset: "Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·",
        results: "ğŸ“Š Ø§Ù„Ù†ØªØ§Ø¦Ø¬",
        nfe_label: "% NFE (Ø§Ù„ÙƒØ§Ø±Ø¨ Ø§Ù„Ù…Ø­Ø³ÙˆØ¨)",
        kcal100_label: "kcal Ù„ÙƒÙ„ 100Øº",
        kcal_serving: "Ø§Ù„Ø³Ø¹Ø±Ø§Øª Ù„ÙƒÙ„ Ø­ØµÙ‘Ø©",
        col_item: "Ø§Ù„Ø¹Ù†ØµØ±",
        col_grams: "ØºØ±Ø§Ù… Ù„ÙƒÙ„ Ø­ØµÙ‘Ø©",
        p: "Ø§Ù„Ø¨Ø±ÙˆØªÙŠÙ†", f: "Ø§Ù„Ø¯Ù‡ÙˆÙ†", fi:"Ø§Ù„Ø£Ù„ÙŠØ§Ù", m:"Ø§Ù„Ø±Ø·ÙˆØ¨Ø©", a:"Ø§Ù„Ø±Ù…Ø§Ø¯", nfe:"NFE (Ø§Ù„ÙƒØ§Ø±Ø¨)",
        rights: "Â© 2025 albraichy â€” Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø©."
      },
      en: {
        title: "Cat Food Serving Calculator",
        inputs: "âš™ï¸ Inputs",
        serving_label: "Serving size (g)",
        protein: "Protein %",
        fat: "Fat %",
        fiber: "Fiber %",
        moisture: "Moisture %",
        ash: "Ash %",
        calc: "Calculate",
        reset: "Reset",
        results: "ğŸ“Š Results",
        nfe_label: "% NFE (calculated carbs)",
        kcal100_label: "kcal per 100 g",
        kcal_serving: "kcal per serving",
        col_item: "Item",
        col_grams: "Grams per serving",
        p: "Protein", f: "Fat", fi:"Fiber", m:"Moisture", a:"Ash", nfe:"NFE (carbs)",
        rights: "Â© 2025 albraichy â€” All rights reserved."
      }
    };

    function setLang(lang){
      const dict = STR[lang];
      document.documentElement.lang = lang === 'ar' ? 'ar' : 'en';
      document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
      // toggle active buttons
      document.getElementById('btn-ar').classList.toggle('active', lang==='ar');
      document.getElementById('btn-en').classList.toggle('active', lang==='en');

      // update texts
      document.querySelectorAll('[data-i18n]').forEach(el=>{
        const key = el.getAttribute('data-i18n');
        if (dict[key]) el.textContent = dict[key];
      });
      document.getElementById('rights').textContent = dict.rights;
    }

    // Modified Atwater factors (kcal per gram)
    const ATW = { protein: 3.5, fat: 8.5, carb: 3.5 };

    function parseNum(el){
      // accept , or .
      const v = el.value.replace(',', '.');
      const n = parseFloat(v);
      return isFinite(n) ? n : 0;
    }
    function nfePercent(p,f,fi,m,a){
      let s = (p||0)+(f||0)+(fi||0)+(m||0)+(a||0);
      return 100 - s;
    }
    function kcalPer100g(p,f,fi,m,a){
      const nfe = nfePercent(p,f,fi,m,a);
      const kcal = (p*ATW.protein) + (nfe*ATW.carb) + (f*ATW.fat);
      return { kcal100: kcal, nfe };
    }
    function byPct(serving, pct){ return serving * (pct/100); }
    function fmt(x, d=1){ return (isFinite(x)? Number(x).toFixed(d): 'â€”'); }

    function calc(){
      const serving = parseNum(document.getElementById('serving'));
      const p = parseNum(document.getElementById('protein'));
      const f = parseNum(document.getElementById('fat'));
      const fi = parseNum(document.getElementById('fiber'));
      const m = parseNum(document.getElementById('moisture'));
      const a = parseNum(document.getElementById('ash'));

      if(!(serving>0)){ alert(document.documentElement.lang==='ar' ? 'Ø­Ø¬Ù… Ø§Ù„Ø­ØµÙ‘Ø© Ù„Ø§Ø²Ù… ÙŠÙƒÙˆÙ† Ø±Ù‚Ù… ØµØ­ÙŠØ­ (>0).' : 'Serving size must be > 0.'); return; }

      const { kcal100, nfe } = kcalPer100g(p,f,fi,m,a);
      const kcalServing = kcal100 * (serving/100);

      const gP = byPct(serving, p);
      const gF = byPct(serving, f);
      const gFi = byPct(serving, fi);
      const gM = byPct(serving, m);
      const gA = byPct(serving, a);
      const gN = byPct(serving, nfe);

      document.getElementById('nfePct').textContent = fmt(nfe, 1);
      document.getElementById('kcal100').textContent = fmt(kcal100, 1);
      document.getElementById('kcalServing').textContent = fmt(kcalServing, 1);

      document.getElementById('gProtein').textContent = fmt(gP, 1);
      document.getElementById('gFat').textContent = fmt(gF, 1);
      document.getElementById('gFiber').textContent = fmt(gFi, 1);
      document.getElementById('gMoisture').textContent = fmt(gM, 1);
      document.getElementById('gAsh').textContent = fmt(gA, 1);
      document.getElementById('gNfe').textContent = fmt(gN, 1);
    }

    function resetAll(){
      ['serving','protein','fat','fiber','moisture','ash'].forEach(id=>document.getElementById(id).value='');
      ['nfePct','kcal100','kcalServing','gProtein','gFat','gFiber','gMoisture','gAsh','gNfe'].forEach(id=>document.getElementById(id).textContent='â€”');
    }

    document.getElementById('calc').addEventListener('click', calc);
    document.getElementById('reset').addEventListener('click', resetAll);
    document.getElementById('btn-ar').addEventListener('click', ()=>setLang('ar'));
    document.getElementById('btn-en').addEventListener('click', ()=>setLang('en'));

    // init
    setLang('ar');
  </script>
</body>
</html>
